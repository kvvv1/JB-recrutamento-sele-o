{% extends 'base.html' %}

{% block title %}Banco R&S{% endblock %}

{% block content %}

<style>
    .back-button {
        position: absolute;
        top: 20px;
        left: 250px;
        z-index: 1050;
        padding: 10px 15px;
        background-color: #AB1A18;
        color: white;
        border-radius: 5px;
        text-decoration: none;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: left 0.3s ease;
    }

    .back-button:hover {
        background-color: #8E1615;
        color: white;
        text-decoration: none;
    }

    .btn-primary {
        background-color: #AB1A18;
        border-color: #AB1A18;
    }

    .btn-primary:hover {
        background-color: #8E1615;
        border-color: #8E1615;
    }

    .btn-criar {
        position: relative;
        /* Relativo à posição onde está inserido no fluxo da página */
        float: right;
        /* Faz com que o botão vá para o canto direito do contêiner em que está */
        margin-bottom: 20px;
        /* Espaçamento abaixo do botão para não ficar muito grudado na tabela */
        padding: 10px 20px;
        background-color: #AB1A18;
        color: white;
        border-radius: 5px;
        text-decoration: none;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s ease, transform 0.3s ease;
    }

    .btn-criar:hover {
        background-color: #8E1615;
        color: white;
        text-decoration: none;
        transform: translateY(-3px);
    }

    .btn-criar i {
        margin-right: 5px;
    }


    .no-results {
        text-align: center;
        color: #AB1A18;
        font-weight: bold;
        margin-top: 20px;
    }

    /* Estilização para a linha de detalhes */
    .detalhes-ficha {
        background-color: #f9f9f9;
        border-top: 1px solid #ddd;
    }

    .conteudo-detalhes {
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #ffffff;
    }

    /* Botão com a seta */
    .btn-seta {
        background-color: #6c757d;
        color: white;
        border: none;
        font-size: 14px;
        padding: 5px 10px;
    }

    .btn-seta:hover {
        background-color: #5a6268;
    }


    .offcanvas-body iframe {
        border: none;
        /* Remove a borda do iframe */
        height: 100%;
        /* Preenche a altura do modal */
        width: 100%;
        /* Preenche a largura do modal */
    }
</style>
<style>
    .btn-warning i {
        font-size: 1.2em;
        /* Tamanho do ícone */
    }

    .badge {
        font-size: 14px;
        padding: 10px;
    }

    .text-danger {
        cursor: pointer;
        font-weight: bold;
        text-decoration: none;
    }

    .text-danger:hover {
        color: #ff0000;
        text-decoration: none;
    }

    td:nth-child(3) {
        /* Cargo Indicado */
        max-width: 350px;
        /* Ajuste conforme necessário */
        white-space: normal;
        /* Permite a quebra apenas em espaços */
        word-break: keep-all;
        /* Mantém palavras inteiras */
        overflow-wrap: break-word;
        /* Evita overflow */
    }
</style>

<a href="{{ url_for('sistema_rs') }}" class="back-button">
    <i class="fas fa-arrow-left"></i>
    Voltar
</a>

{% if msg %}
<div class="alert alert-warning">{{ msg }}</div>
{% endif %}

<div class="container mt-5">
    <h2 class="text-center mb-4">Banco de Recrutamento e Seleção</h2>

    <!-- Filtros de Pesquisa -->
    <!-- Filtros de Pesquisa -->
    <form id="filterForm" method="GET" action="{{ url_for('banco_rs') }}">
        <div class="row mb-4">
            <!-- Filtro por Nome Completo -->
            <div class="col-md-4">
                <label for="nome">Nome Completo</label>
                <input type="text" class="form-control" id="nome" name="nome"
                    value="{{ request.args.get('nome', '') }}">
            </div>

            <!-- Filtro por CPF -->
            <div class="col-md-4">
                <label for="cpf">CPF</label>
                <input type="text" class="form-control" id="cpf" name="cpf" value="{{ request.args.get('cpf', '') }}">
            </div>

            <!-- Filtro por Gênero -->
            <div class="col-md-4">
                <label for="genero">Genêro </label>
                <select class="form-control" id="genero" name="genero">
                    <option value="" selected>Todos</option>
                    <option value="Homem" {% if request.args.get('genero')=='Masculino' %}selected{% endif %}>
                        Masculino</option>
                    <option value="Mulher" {% if request.args.get('genero')=='Feminino' %}selected{% endif %}>Feminino
                    </option>
                </select>
            </div>

            <!-- Filtro por Estado Civil -->
            <div class="col-md-4">
                <label for="estado_civil">Estado Civil</label>
                <select class="form-control" id="estado_civil" name="estado_civil">
                    <option value="" selected>Todos</option>
                    <option value="Solteiro" {% if request.args.get('estado_civil')=='Solteiro' %}selected{% endif %}>
                        Solteiro</option>
                    <option value="Casado" {% if request.args.get('estado_civil')=='Casado' %}selected{% endif %}>Casado
                    </option>
                    <option value="Divorciado" {% if request.args.get('estado_civil')=='Divorciado' %}selected{% endif
                        %}>Divorciado</option>
                    <option value="Viúvo" {% if request.args.get('estado_civil')=='Viúvo' %}selected{% endif %}>Viúvo
                    </option>
                </select>
            </div>
            <!-- Filtro por Fumante -->
            <div class="col-md-4">
                <label for="fumante">Fumante</label>
                <select class="form-control" id="fumante" name="fumante">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('fumante')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('fumante')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <!-- Filtro por Bebida -->
            <div class="col-md-4">
                <label for="bebida">Bebida</label>
                <select class="form-control" id="bebida" name="bebida">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('bebida')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('bebida')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <!-- Filtro por Alergia -->
            <div class="col-md-4">
                <label for="alergia">Alergia</label>
                <select class="form-control" id="alergia" name="alergia">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('alergia')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('alergia')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <!-- Filtro por Medicamento de Uso Constante -->
            <div class="col-md-4">
                <label for="medicamento">Medicamento de Uso Constante</label>
                <select class="form-control" id="medicamento" name="medicamento">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('medicamento')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('medicamento')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <!-- Filtro por PCD -->
            <div class="col-md-4">
                <label for="pcd">PCD (Pessoa com Deficiência)</label>
                <select class="form-control" id="pcd" name="pcd">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('pcd')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('pcd')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <!-- Filtro por Tatuagem -->
            <div class="col-md-4">
                <label for="tatuagem">Tatuagem</label>
                <select class="form-control" id="tatuagem" name="tatuagem">
                    <option value="" selected>Todos</option>
                    <option value="Sim, Visível" {% if request.args.get('tatuagem')=='Sim, Visível' %}selected{% endif
                        %}>Sim, Visível</option>
                    <option value="Sim" {% if request.args.get('tatuagem')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('tatuagem')=='Não' %}selected{% endif %}>Não</option>
                </select>
            </div>

            <style>
                #dropdown-regioes {
                    position: relative;
                    display: inline-block;
                    width: 100%;
                }

                #dropdownMenuButton {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    width: 100%;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    background-color: #fff;
                    padding: 8px 12px;
                    cursor: pointer;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                #dropdownMenuButton::after {
                    content: '\25BC';
                    /* Seta indicando dropdown */
                    font-size: 12px;
                    color: #666;
                    margin-left: auto;
                }

                .dropdown-menu {
                    width: 100%;
                    max-height: 200px;
                    overflow-y: auto;
                    padding: 0;
                    /* Removendo padding para alinhar corretamente */
                    border: 1px solid #ccc;
                }

                .dropdown-menu li {
                    display: flex;
                    align-items: center;
                    /* Garante que checkbox e texto fiquem alinhados */
                }

                .dropdown-menu label {
                    display: flex;
                    align-items: center;
                    margin: 0;
                    cursor: pointer;
                    width: 100%;
                }

                .dropdown-menu input[type="checkbox"] {
                    margin-right: 8px;
                    /* Espaço entre o checkbox e o texto */
                }

                .dropdown-menu input[type="checkbox"]+label {
                    width: auto;
                }

                #dropdown-title {
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                    max-width: 100%;
                    display: inline-block;
                }

                .dropdown-menu .form-check {
                    display: flex;
                    align-items: center;
                }

                .dropdown-menu .form-check-label {
                    margin: 0;
                    padding-left: 5px;
                }
            </style>
            <!-- Filtro por Regiões de Preferência -->
            <!-- Filtro por Regiões de Preferência -->
            <div class="col-md-4">
                <!-- Campo de Regiões de Preferência com checkboxes -->
                <div class="form-group">
                    <label for="regioes_preferencia">Regiões de Preferência</label>
                    <div class="dropdown" id="dropdown-regioes">
                        <button class="btn btn-light dropdown-toggle form-control" type="button" id="dropdownMenuButton"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            <span id="dropdown-title">Selecione as regiões</span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="dropdown-options"
                            style="width: 100%;">
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Barreiro"
                                        {% if 'Região Barreiro' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Barreiro</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Centro Sul"
                                        {% if 'Região Centro Sul' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    Região Centro Sul</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Leste"
                                        {% if 'Região Leste' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Leste</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Nordeste"
                                        {% if 'Região Nordeste' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Nordeste</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Noroeste"
                                        {% if 'Região Noroeste' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Noroeste</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Norte"
                                        {% if 'Região Norte' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Norte</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Oeste"
                                        {% if 'Região Oeste' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Oeste</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Pampulha"
                                        {% if 'Região Pampulha' in request.args.getlist('regioes_preferencia') %}checked{% endif %}> Região
                                    Pampulha</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Venda Nova"
                                        {% if 'Região Venda Nova' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    Região Venda Nova</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Betim/Contagem"
                                        {% if 'Região Betim/Contagem' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    Região Betim/Contagem</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Região Nova Lima"
                                        {% if 'Região Nova Lima' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    Região Nova Lima</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="VLI SUDESTE"
                                        {% if 'VLI SUDESTE' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    VLI SUDESTE</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="VLI NORDESTE"
                                        {% if 'VLI NORDESTE' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    VLI NORDESTE</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="VLI CENTRO LESTE"
                                        {% if 'VLI CENTRO LESTE' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    VLI CENTRO LESTE</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="VLI MG"
                                        {% if 'VLI MG' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    VLI MG</label></li>
                            <li><label><input type="checkbox" name="regioes_preferencia" value="Outros Municípios"
                                        {% if 'Outros Municípios' in request.args.getlist('regioes_preferencia') %}checked{% endif %}>
                                    Outros Municípios</label></li>
                        </ul>
                    </div>
                </div>
            </div>


            <!-- Filtro por Estado de Residência -->
            <div class="col-md-4">
                <label for="estado">Estado de Residência</label>
                <select class="form-control" id="estado" name="estado" onchange="carregarCidades(this.value)">
                    <option value="" selected>Todos</option>
                    <option value="AC" {% if request.args.get('estado')=='AC' %}selected{% endif %}>Acre</option>
                    <option value="AL" {% if request.args.get('estado')=='AL' %}selected{% endif %}>Alagoas</option>
                    <option value="AM" {% if request.args.get('estado')=='AM' %}selected{% endif %}>Amazonas</option>
                    <option value="AP" {% if request.args.get('estado')=='AP' %}selected{% endif %}>Amapá</option>
                    <option value="BA" {% if request.args.get('estado')=='BA' %}selected{% endif %}>Bahia</option>
                    <option value="CE" {% if request.args.get('estado')=='CE' %}selected{% endif %}>Ceará</option>
                    <option value="DF" {% if request.args.get('estado')=='DF' %}selected{% endif %}>Distrito Federal
                    </option>
                    <option value="ES" {% if request.args.get('estado')=='ES' %}selected{% endif %}>Espírito Santo
                    </option>
                    <option value="GO" {% if request.args.get('estado')=='GO' %}selected{% endif %}>Goiás</option>
                    <option value="MA" {% if request.args.get('estado')=='MA' %}selected{% endif %}>Maranhão</option>
                    <option value="MG" {% if request.args.get('estado')=='MG' %}selected{% endif %}>Minas Gerais
                    </option>
                    <option value="MS" {% if request.args.get('estado')=='MS' %}selected{% endif %}>Mato Grosso do Sul
                    </option>
                    <option value="MT" {% if request.args.get('estado')=='MT' %}selected{% endif %}>Mato Grosso</option>
                    <option value="PA" {% if request.args.get('estado')=='PA' %}selected{% endif %}>Pará</option>
                    <option value="PB" {% if request.args.get('estado')=='PB' %}selected{% endif %}>Paraíba</option>
                    <option value="PE" {% if request.args.get('estado')=='PE' %}selected{% endif %}>Pernambuco</option>
                    <option value="PI" {% if request.args.get('estado')=='PI' %}selected{% endif %}>Piauí</option>
                    <option value="PR" {% if request.args.get('estado')=='PR' %}selected{% endif %}>Paraná</option>
                    <option value="RJ" {% if request.args.get('estado')=='RJ' %}selected{% endif %}>Rio de Janeiro
                    </option>
                    <option value="RN" {% if request.args.get('estado')=='RN' %}selected{% endif %}>Rio Grande do Norte
                    </option>
                    <option value="RO" {% if request.args.get('estado')=='RO' %}selected{% endif %}>Rondônia</option>
                    <option value="RR" {% if request.args.get('estado')=='RR' %}selected{% endif %}>Roraima</option>
                    <option value="RS" {% if request.args.get('estado')=='RS' %}selected{% endif %}>Rio Grande do Sul
                    </option>
                    <option value="SC" {% if request.args.get('estado')=='SC' %}selected{% endif %}>Santa Catarina
                    </option>
                    <option value="SE" {% if request.args.get('estado')=='SE' %}selected{% endif %}>Sergipe</option>
                    <option value="SP" {% if request.args.get('estado')=='SP' %}selected{% endif %}>São Paulo</option>
                    <option value="TO" {% if request.args.get('estado')=='TO' %}selected{% endif %}>Tocantins</option>
                </select>
            </div>

            <!-- Filtro por Cidade de Residência -->
            <div class="col-md-4">
                <label for="cidade">Cidade de Residência</label>
                <select class="form-control" id="cidade" name="cidade">
                    <option value="" selected>Selecione a cidade</option>
                </select>
            </div>


            <style>
                #dropdown-horario {
                    position: relative;
                    display: inline-block;
                    width: 100%;
                }

                #dropdownMenuButtonHorario {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    width: 100%;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                }

                #dropdown-options-horario {
                    width: 100%;
                    max-height: 200px;
                    overflow-y: auto;
                }

                #dropdown-cargo {
                    position: relative;
                    display: inline-block;
                    width: 100%;
                }

                #dropdownMenuButtonCargo {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    width: 100%;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                    background-color: #fff;
                    padding: 8px 12px;
                    cursor: pointer;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                #dropdownMenuButtonCargo::after {
                    content: '\25BC';
                    font-size: 12px;
                    color: #666;
                    margin-left: auto;
                }

                #dropdown-options-cargo {
                    width: 100%;
                    max-height: 200px;
                    overflow-y: auto;
                    padding: 0;
                    border: 1px solid #ccc;
                }

                #dropdown-options-cargo li {
                    display: flex;
                    align-items: center;
                }

                #dropdown-options-cargo label {
                    display: flex;
                    align-items: center;
                    margin: 0;
                    cursor: pointer;
                    width: 100%;
                }

                #dropdown-options-cargo input[type="checkbox"] {
                    margin-right: 8px;
                }

                #dropdown-title-cargo {
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                    max-width: 100%;
                    display: inline-block;
                }
            </style>

            <!-- Filtro por Disponibilidade de Horário -->
            <div class="col-md-4">
                <div class="form-group">
                    <label for="disponibilidade_horario">Disponibilidade de Horário</label>
                    <div class="dropdown" id="dropdown-horario">
                        <button class="btn btn-light dropdown-toggle form-control" type="button"
                            id="dropdownMenuButtonHorario" data-bs-toggle="dropdown" aria-expanded="false">
                            <span id="dropdown-title-horario">Selecione a disponibilidade</span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonHorario"
                            id="dropdown-options-horario" style="width: 100%;">
                            <li><label><input type="checkbox" name="disponibilidade_horario"
                                        value="44h (Horário Comercial)"
                                        {% if '44h (Horário Comercial)' in request.args.getlist('disponibilidade_horario') %}checked{% endif %}>
                                    44h (Horário Comercial)</label></li>
                            <li><label><input type="checkbox" name="disponibilidade_horario" value="12x36 Dia"
                                        {% if '12x36 Dia' in request.args.getlist('disponibilidade_horario') %}checked{% endif %}>
                                    12x36 Dia</label></li>
                            <li><label><input type="checkbox" name="disponibilidade_horario" value="12x36 Noite"
                                        {% if '12x36 Noite' in request.args.getlist('disponibilidade_horario') %}checked{% endif %}>
                                    12x36 Noite</label></li>
                            <li><label><input type="checkbox" name="disponibilidade_horario" value="Feirista"
                                        {% if 'Feirista' in request.args.getlist('disponibilidade_horario') %}checked{% endif %}>
                                    Ferista</label></li>
                        </ul>
                    </div>
                </div>
            </div>



            <!-- Filtro por Cargo Indicado -->
            <div class="col-md-4">
                <div class="form-group">
                    <label for="cargo_indicado">Cargo Indicado</label>
                    <div class="dropdown" id="dropdown-cargo">
                        <button class="btn btn-light dropdown-toggle form-control" type="button"
                            id="dropdownMenuButtonCargo" data-bs-toggle="dropdown" aria-expanded="false">
                            <span id="dropdown-title-cargo">Selecione os cargos</span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonCargo"
                            id="dropdown-options-cargo" style="width: 100%;">
                            <li><label><input type="checkbox" name="cargo_indicado" value="Portaria"
                                        {% if 'Portaria' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Portaria</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Manutenção"
                                        {% if 'Manutenção' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Manutenção</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Administrativo"
                                        {% if 'Administrativo' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Administrativo</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Jovem Aprendiz Limpeza"
                                        {% if 'Jovem Aprendiz Limpeza' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Jovem Aprendiz Limpeza</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Jovem Aprendiz Administrativo"
                                        {% if 'Jovem Aprendiz Administrativo' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Jovem Aprendiz Administrativo</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Manobrista"
                                        {% if 'Manobrista' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Manobrista</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="Recepcionista"
                                        {% if 'Recepcionista' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Recepcionista</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="ASG"
                                        {% if 'ASG' in request.args.getlist('cargo_indicado') %}checked{% endif %}>ASG</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="ZELADORIA"
                                        {% if 'ZELADORIA' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Zeladoria</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="MENSAGEIRO"
                                        {% if 'MENSAGEIRO' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Mensageiro</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="COPEIRA"
                                        {% if 'COPEIRA' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Copeira</label></li>
                            <li><label><input type="checkbox" name="cargo_indicado" value="SUPERVISOR PREDIAL"
                                        {% if 'SUPERVISOR PREDIAL' in request.args.getlist('cargo_indicado') %}checked{% endif %}>Supervisor Predial</label></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Filtro por Recrutador -->
            <div class="col-md-4">
                <label for="recrutador">Recrutador</label>
                <select class="form-control" id="recrutador" name="recrutador">
                    <option value="" selected>Todos</option>
                    <option value="samira.barbosa" {% if request.args.get('recrutador')=='samira.barbosa' %}selected{%
                        endif %}>Samira Barbosa</option>
                    <option value="nara.rodrigues" {% if request.args.get('recrutador')=='nara.rodrigues' %}selected{%
                        endif %}>Nara Rodrigues</option>
                    <option value="wilson.monteiro" {% if request.args.get('recrutador')=='wilson.monteiro' %}selected{%
                        endif %}>Wilson Monteiro</option>
                    <option value="vivian.wanderley" {% if request.args.get('recrutador')=='vivian.wanderley'
                        %}selected{% endif %}>Vivian Wanderley</option>
                    <option value="grasielle.mapa" {% if request.args.get('recrutador')=='grasielle.mapa' %}selected{%
                        endif %}>Grasielle Mapa</option>
                    <option value="guilherme.vieira" {% if request.args.get('recrutador')=='guilherme.vieira' %}selected{%
                        endif %}>Guilherme Vieira</option>
                    <option value="não definido">Não Definido</option>

                </select>
            </div>



            <!-- Filtro por Avaliação RH -->
            <div class="col-md-4">
                <label for="avaliacao_rh">Avaliação RH</label>
                <select class="form-control" id="avaliacao_rh" name="avaliacao_rh">
                    <option value="" selected>Todos</option>
                    <option value="Aprovado" {% if request.args.get('avaliacao_rh')=='Aprovado' %}selected{% endif %}>
                        Aprovado</option>
                    <option value="Reprovado" {% if request.args.get('avaliacao_rh')=='Reprovado' %}selected{% endif %}>
                        Reprovado</option>
                </select>
            </div>

            <!-- Filtro por Avaliação Gerência -->
            <div class="col-md-4">
                <label for="avaliacao_gerencia">Avaliação Gestor</label>
                <select class="form-control" id="avaliacao_gerencia" name="avaliacao_gerencia">
                    <option value="" selected>Todos</option>
                    <option value="Aprovado" {% if request.args.get('avaliacao_gerencia')=='Aprovado' %}selected{% endif
                        %}>Aprovado</option>
                    <option value="Reprovado" {% if request.args.get('avaliacao_gerencia')=='Reprovado' %}selected{%
                        endif %}>Reprovado</option>
                    <option value="Em Conversa" {% if request.args.get('avaliacao_gerencia')=='Em Conversa' %}selected{%
                        endif %}>Em Conversa</option>
                </select>
            </div>

            <div class="col-md-4">
                <label for="avaliacao_geral">Avaliação Geral</label>
                <select class="form-control" id="avaliacao_geral" name="avaliacao_geral">
                    <option value="" selected>Todos</option>
                    <option value="Aprovado" {% if request.args.get('avaliacao_geral')=='Aprovado' %}selected{% endif
                        %}>Aprovado</option>
                    <option value="Reprovado" {% if request.args.get('avaliacao_geral')=='Reprovado' %}selected{% endif
                        %}>Reprovado</option>
                    <option value="Em Conversa" {% if request.args.get('avaliacao_geral')=='Em Conversa' %}selected{%
                        endif %}>Em Conversa</option>
                    <option value="Não Avaliado" {% if request.args.get('avaliacao_geral')=='Não Avaliado' %}selected{%
                        endif %}>Não Avaliado</option>
                </select>
            </div>

            <div class="col-md-4">
                <label for="sindicancia">Sindicância</label>
                <select class="form-control" id="sindicancia" name="sindicancia">
                    <option value="" selected>Todos</option>
                    <option value="Em Verificação" {% if request.args.get('sindicancia')=='Em Verificação' %}selected{%
                        endif %}>Em Verificação</option>
                    <option value="Aprovado" {% if request.args.get('sindicancia')=='Aprovado' %}selected{% endif %}>
                        Aprovado</option>
                    <option value="Reprovado" {% if request.args.get('sindicancia')=='Reprovado' %}selected{% endif %}>
                        Reprovado</option>
                </select>
            </div>

            <!-- Filtro por Assinatura da Gerência -->
            <div class="col-md-4">
                <label for="assinatura_gerencia">Assinatura da Gerência</label>
                <select class="form-control" id="assinatura_gerencia" name="assinatura_gerencia">
                    <option value="" selected>Todos</option>
                    <option value="Gilson Coelho" {% if request.args.get('assinatura_gerencia')=='Gilson Coelho'
                        %}selected{% endif %}>Gilson Coelho</option>
                    <option value="Jefferson Marques" {% if request.args.get('assinatura_gerencia')=='Jefferson Marques'
                        %}selected{% endif %}>Jefferson Marques</option>
                    <option value="Mauro Raidan" {% if request.args.get('assinatura_gerencia')=='Mauro Raidan'
                        %}selected{% endif %}>Mauro Raidan</option>
                    <option value="Ronaldo Oliveira" {% if request.args.get('assinatura_gerencia')=='Ronaldo Oliveira'
                        %}selected{% endif %}>Ronaldo Oliveira</option>
                    <option value="Warlley Martins" {% if request.args.get('assinatura_gerencia')=='Warlley Martins'
                        %}selected{% endif %}>Warlley Martins</option>
                    <option value="Wilder Martins" {% if request.args.get('assinatura_gerencia')=='Wilder Martins'
                        %}selected{% endif %}>Wilder Martins</option>
                    <option value="Wendel Dutra" {% if request.args.get('assinatura_gerencia')=='Wendel Dutra'
                        %}selected{% endif %}>Wendel Dutra</option>
                    <option value="André Buzin" {% if request.args.get('assinatura_gerencia')=='André Buzin'
                        %}selected{% endif %}>André Buzin</option>
                    <option value="Xenia Faria" {% if request.args.get('assinatura_gerencia')=='Xenia Faria'
                        %}selected{% endif %}>Xenia Faria</option>
                </select>
            </div>

            <!-- Filtro por Admitido -->
            <div class="col-md-4">
                <label for="admitido">Admitido</label>
                <select class="form-control" id="admitido" name="admitido">
                    <option value="" selected>Todos</option>
                    <option value="Sim" {% if request.args.get('admitido')=='Sim' %}selected{% endif %}>Sim</option>
                    <option value="Não" {% if request.args.get('admitido')=='Não' %}selected{% endif %}>Não</option>
                    <option value="Em processo de admissão" {% if request.args.get('admitido')=='Em processo de admissão' %}selected{% endif %}>Em processo de admissão</option>
                </select>
            </div>

            <!-- Filtro por Situação -->
            <div class="col-md-4">
                <label for="situacao">Situação</label>
                <select class="form-control" id="situacao" name="situacao">
                    <option value="" selected>Todos</option>
                    <option value="Admitido" {% if request.args.get('situacao')=='Admitido' %}selected{% endif %}>Admitido</option>
                    <option value="Em processo de admissão" {% if request.args.get('situacao')=='Em processo de admissão' %}selected{% endif %}>Em processo de admissão</option>
                    <option value="Aprovado" {% if request.args.get('situacao')=='Aprovado' %}selected{% endif %}>Aprovado</option>
                    <option value="Aprovado RH" {% if request.args.get('situacao')=='Aprovado RH' %}selected{% endif %}>Aprovado RH</option>
                    <option value="Reprovado" {% if request.args.get('situacao')=='Reprovado' %}selected{% endif %}>Reprovado</option>
                    <option value="Reprovado RH" {% if request.args.get('situacao')=='Reprovado RH' %}selected{% endif %}>Reprovado RH</option>
                    <option value="Em Verificação" {% if request.args.get('situacao')=='Em Verificação' %}selected{% endif %}>Em Verificação</option>
                    <option value="Em Conversa" {% if request.args.get('situacao')=='Em Conversa' %}selected{% endif %}>Em Conversa</option>
                    <option value="Não Avaliado" {% if request.args.get('situacao')=='Não Avaliado' %}selected{% endif %}>Não Avaliado</option>
                </select>
            </div>


        </div>

        <!-- Botões de Filtrar e Limpar -->
        <div class="mt-3">
            <button type="submit" class="btn btn-primary">Filtrar</button>
            <a href="{{ url_for('banco_rs') }}" class="btn btn-secondary">Limpar Filtros</a>
        </div>
    </form>
    <!-- Linha horizontal -->
    <hr>
    <!-- Exibição dos filtros selecionados -->
    <!-- Exibição dos filtros selecionados -->
    <div id="filtros-selecionados" class="mt-3">
        {% if filtros_ativos %}
        <p>Filtros aplicados:</p>
        <ul>
            {% for key, value in filtros_ativos.items() %}
            <li>
                <strong>{{ filtro_nomes_amigaveis[key] if key in filtro_nomes_amigaveis else key }}:</strong> {{ value
                }}
                <a href="{{ filtro_remocao_links[key] }}" class="text-danger ms-2">
                    <i class="fas fa-times"></i> Remover
                </a>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>Nenhum filtro aplicado.</p>
        {% endif %}
    </div>

</div>


<!-- Modal para criar ficha -->
<div class="modal fade" id="createFichaModal" tabindex="-1" aria-labelledby="createFichaModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createFichaModalLabel">Criar Ficha Manualmente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="POST" action="{{ url_for('create_ficha_manual') }}">
                    <div class="mb-3">
                        <label for="nomeCompleto" class="form-label">Nome Completo</label>
                        <input type="text" class="form-control" id="nomeCompleto" name="nome_completo" required>
                    </div>
                    <div class="mb-3">
                        <label for="cpf" class="form-label">CPF</label>
                        <input type="text" class="form-control" id="cpf" name="cpf" required oninput="mascaraCPF(this)">
                    </div>
                    <div class="mb-3">
                        <label for="data_nascimento" class="form-label">Data de Nascimento</label>
                        <input type="date" class="form-control" id="data_nascimento" name="data_nasc">
                    </div>
                    <button type="submit" class="btn btn-primary">Criar Ficha</button>
                </form>
            </div>
        </div>
    </div>
</div>



<script>
    // Função para aplicar máscara de CPF no campo de input
    function mascaraCPF(cpfInput) {
        cpfInput.value = cpfInput.value
            .replace(/\D/g, '')                    // Remove caracteres não numéricos
            .replace(/(\d{3})(\d)/, '$1.$2')      // Adiciona ponto após os três primeiros dígitos
            .replace(/(\d{3})(\d)/, '$1.$2')      // Adiciona ponto após os seis primeiros dígitos
            .replace(/(\d{3})(\d{1,2})/, '$1-$2') // Adiciona o traço antes dos dois últimos dígitos
            .replace(/(-\d{2})\d+?$/, '$1');      // Limita o CPF a 11 dígitos
    }

    // Aplica a máscara quando o usuário digita no campo de CPF
    document.getElementById('cpf').addEventListener('input', function () {
        mascaraCPF(this);
    });
</script>

<!-- Botão + Criar Ficha -->
<div class="d-flex justify-content-end mb-4 mt-4">
    <button type="button" class="btn btn-primary btn-criar" data-bs-toggle="modal" data-bs-target="#createFichaModal">
        + CRIAR FICHA
    </button>
</div>

<!-- Botão para abrir o modal -->
<div class="d-flex justify-content-end mb-4 mt-4">
    <button type="button" class="btn btn-success" id="openPdfModalButton" style="display: none;" data-bs-toggle="modal"
        data-bs-target="#pdfModal">
        Gerar PDF com Selecionados
    </button>
</div>



<!-- Tabela de Resultados -->
<div id="resultados">
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <th><input type="checkbox" id="selectAll" /></th>
                <th>Nome</th>
                <th>Cargo Indicado</th>
                <th>
                    Data de Submissão
                    <a href="{{ url_for('banco_rs', **args_date_asc) }}" class="text-decoration-none"
                        title="Ordenar por Data Crescente">
                        <i class="fas fa-arrow-up"></i>
                    </a>
                    <a href="{{ url_for('banco_rs', **args_date_desc) }}" class="text-decoration-none"
                        title="Ordenar por Data Decrescente">
                        <i class="fas fa-arrow-down"></i>
                    </a>
                </th>
                <th>Cidade/Bairro</th>
                <th>Recrutador</th>
                <th>Situação</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody id="candidato-table">
            {% if candidatos|length > 0 %}
            {% for candidato in candidatos %}
            <tr class="main-row">
                <td><input type="checkbox" class="select-checkbox" value="{{ candidato.cpf }}" /></td>
                <td>{{ candidato.nome_completo }}</td>
                <td>{{ candidato.cargo_indicado or 'Não informado' }}</td>
                <td>{{ candidato.created_at }}</td>
                <td>{{ candidato.cidade_bairro }}</td>
                <td>{{ candidato.recrutador or 'Não definido' }}</td>
                <td>{{ candidato.situacao }}</td>
                <td>

                    <button class="btn btn-warning btn-sm" onclick="openEditForm('{{ candidato.cpf }}')">
                        <i class="fas fa-eye"></i>
                    </button>


                    <a href="{{ url_for('view_form', cpf=candidato.cpf) }}" class="btn btn-primary"
                        target="_blank">Visualizar</a>
                    <a href="{{ url_for('export_pdf', cpf=candidato.cpf) }}" class="btn btn-danger btn-sm"
                        target="_blank">PDF</a>
                    <a href="{{ url_for('export_excel', cpf=candidato.cpf) }}" class="btn btn-success btn-sm"
                        target="_blank">EXCEL</a>
                </td>
            </tr>

            {% endfor %}
            {% else %}
            <tr>
                <td colspan="7" class="text-center">Nenhum candidato encontrado com os filtros aplicados.</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="pagination-options mt-3">
        <!-- Select para número de itens por página -->
        <label for="itemsPerPage">Fichas por página:</label>
        <select id="itemsPerPage" class="form-control d-inline-block w-auto">
            <option value="10" {% if request.args.get('items_per_page')=='10' %}selected{% endif %}>10</option>
            <option value="20" {% if request.args.get('items_per_page')=='20' %}selected{% endif %}>20</option>
            <option value="50" {% if request.args.get('items_per_page')=='50' %}selected{% endif %}>50</option>
            <option value="100" {% if request.args.get('items_per_page')=='100' %}selected{% endif %}>100</option>
        </select>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-3">
        <span>Candidatos exibidos: {{ start_candidate }}-{{ end_candidate }} de {{ total_candidates }}</span>
    </div>

</div>

<!-- Modal para confirmar a geração do PDF -->
<div class="modal fade" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="pdfModalLabel">Gerar PDF</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Você selecionou os candidatos. Deseja gerar um PDF com os nomes e CPFs selecionados?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="generatePdfButton">Gerar PDF</button>
            </div>
        </div>
    </div>
</div>

<!-- O novo container de paginação que será atualizado via AJAX -->
<div id="pagination">
    {% if pagination.total_pages > 1 %}
    <nav aria-label="Navegação de página">
        <ul class="pagination justify-content-center flex-wrap">
            <!-- Página anterior -->
            {% if pagination.has_prev %}
            <li class="page-item">
                <a href="{{ url_for('banco_rs', **dict(request.args.to_dict(), page=pagination.prev_num)) }}"
                    class="page-link">&laquo;</a>
            </li>
            {% else %}
            <li class="page-item disabled">
                <span class="page-link">&laquo;</span>
            </li>
            {% endif %}

            <!-- Primeira página, se necessário -->
            {% if pagination.start_page > 1 %}
            <li class="page-item">
                <a href="{{ url_for('banco_rs', **dict(request.args.to_dict(), page=1)) }}" class="page-link">1</a>
            </li>
            {% if pagination.start_page > 2 %}
            <li class="page-item disabled"><span class="page-link">...</span></li>
            {% endif %}
            {% endif %}

            <!-- Páginas visíveis ao redor da atual -->
            {% for page_num in range(pagination.start_page, pagination.end_page + 1) %}
            <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                <a href="{{ url_for('banco_rs', **dict(request.args.to_dict(), page=page_num)) }}" class="page-link">{{
                    page_num }}</a>
            </li>
            {% endfor %}

            <!-- Última página, se necessário -->
            {% if pagination.end_page < pagination.total_pages %} {% if pagination.end_page < pagination.total_pages - 1
                %} <li class="page-item disabled"><span class="page-link">...</span></li>
                {% endif %}
                <li class="page-item">
                    <a href="{{ url_for('banco_rs', **dict(request.args.to_dict(), page=pagination.total_pages)) }}"
                        class="page-link">{{ pagination.total_pages }}</a>
                </li>
                {% endif %}

                <!-- Próxima página -->
                {% if pagination.has_next %}
                <li class="page-item">
                    <a href="{{ url_for('banco_rs', **dict(request.args.to_dict(), page=pagination.next_num)) }}"
                        class="page-link">&raquo;</a>
                </li>
                {% else %}
                <li class="page-item disabled">
                    <span class="page-link">&raquo;</span>
                </li>
                {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>

<!-- Aviso de carregamento -->
<div id="loading-indicator" style="display: none; text-align: center; margin-top: 10px;">
    <p>Carregando...</p>
</div>

<!-- Pré-carregamento da próxima página -->
<div id="next-page-content" style="display: none;"></div>

<!-- Modal de Edição da Ficha -->
<div class="modal fade" id="editRegistrationModal" tabindex="-1" aria-labelledby="editRegistrationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editRegistrationModalLabel">Editar Ficha de Inscrição</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-registration-form" action="/update_registration" method="POST">
                <div class="modal-body">

                    <!-- Informações principais no topo -->
                    <div class="mb-4 border rounded p-3 bg-light">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="edit-recrutador">Recrutador:</label>
                                <input type="text" id="edit-recrutador" name="recrutador" class="form-control" readonly>
                            </div>
                            <div class="col-md-4">
                                <label for="edit-situacao">Situação:</label>
                                <input type="text" id="edit-situacao" name="situacao" class="form-control" readonly>
                            </div>
                            <div class="col-md-4">
                                <label for="edit-cpf">CPF:</label>
                                <input type="text" id="edit-cpf" name="cpf" class="form-control" readonly>
                            </div>
                            <div class="col-md-6">
                                <label for="edit-cargo_indicado">Cargo Indicado:</label>
                                <textarea id="edit-cargo_indicado" name="cargo_indicado" class="form-control"
                                    readonly></textarea>
                            </div>
                            <div class="col-md-6">
                                <label for="edit-observacoes">Observações:</label>
                                <textarea id="edit-observacoes" name="observacoes" class="form-control"
                                    readonly></textarea>
                            </div>
                            <div class="col-md-6">
                                <label for="edit-regioes_preferencia">Regiões de Preferência:</label>
                                <textarea id="edit-regioes_preferencia" name="regioes_preferencia" class="form-control"
                                    readonly></textarea>
                            </div>
                            <div class="col-md-6">
                                <label for="edit-disponibilidade_horario">Disponibilidade de Horário:</label>
                                <textarea id="edit-disponibilidade_horario" name="disponibilidade_horario"
                                    class="form-control" readonly></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Dados complementares -->
                    <div class="row g-3">
                        <!-- Coluna 1 -->
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-nome-completo">Nome Completo:</label>
                                <input type="text" id="edit-nome-completo" name="nome_completo" class="form-control"
                                    readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-telefone">Telefone:</label>
                                <input type="text" id="edit-telefone" name="telefone" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-endereco">Endereço:</label>
                                <input type="text" id="edit-endereco" name="endereco" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-bairro">Bairro:</label>
                                <input type="text" id="edit-bairro" name="bairro" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-cidade">Cidade:</label>
                                <input type="text" id="edit-cidade" name="cidade" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-data_nasc">Data de Nascimento:</label>
                                <input type="text" id="edit-data_nasc" name="data_nasc" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-escolaridade">Escolaridade:</label>
                                <input type="text" id="edit-escolaridade" name="escolaridade" class="form-control"
                                    readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-fumante">Fumante:</label>
                                <input type="text" id="edit-fumante" name="fumante" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-bebida">Bebida:</label>
                                <input type="text" id="edit-bebida" name="bebida" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-genero">Gênero:</label>
                                <input type="text" id="edit-genero" name="genero" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-peso">Peso:</label>
                                <input type="text" id="edit-peso" name="peso" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-cor_pele">Cor de Pele:</label>
                                <input type="text" id="edit-cor_pele" name="cor_pele" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-tatuagem">Tatuagem:</label>
                                <input type="text" id="edit-tatuagem" name="tatuagem" class="form-control" readonly>
                            </div>
                        </div>

                        <!-- Coluna 2 -->
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edit-cursos">Cursos Realizados:</label>
                                <input type="text" id="edit-cursos" name="cursos" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-conhecimento_digitacao">Conhecimento de Digitação:</label>
                                <input type="text" id="edit-conhecimento_digitacao" name="conhecimento_digitacao"
                                    class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-avaliacao_rh">Avaliação RH:</label>
                                <input type="text" id="edit-avaliacao_rh" name="avaliacao_rh" class="form-control"
                                    readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-sindicancia">Sindicância:</label>
                                <input type="text" id="edit-sindicancia" name="sindicancia" class="form-control"
                                    readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-avaliacao_gerencia">Avaliação Gestor:</label>
                                <input type="text" id="edit-avaliacao_gerencia" name="avaliacao_gerencia"
                                    class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-assinatura_gerencia">Assinatura Gestor:</label>
                                <input type="text" id="edit-assinatura_gerencia" name="assinatura_gerencia"
                                    class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="edit-admitido">Admitido:</label>
                                <input type="text" id="edit-admitido" name="admitido" class="form-control" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
</div>



<!-- Adiciona o Socket.IO antes dos outros scripts -->
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>

<!-- Adiciona a biblioteca jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- Scripts existentes -->
<script src="{{ url_for('static', filename='js/selecaoTabelaEPaginacao.js') }}"></script>
<script src="{{ url_for('static', filename='js/editRegistrationModal.js') }}"></script>
<script src="{{ url_for('static', filename='js/verify_cpf_ficha.js') }}"></script>
<script src="{{ url_for('static', filename='js/banco_rs_ajax.js') }}"></script>
<script src="{{ url_for('static', filename='js/mascaras.js') }}"></script>
<script src="{{ url_for('static', filename='js/generatePdf.js') }}"></script>
<script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="{{ url_for('static', filename='js/carregarCidadeBancoFiltro.js') }}"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        const closeModalButton = document.getElementById('close-modal-btn');
        const modalElement = document.getElementById('editRegistrationModal');

        if (closeModalButton && modalElement) {
            closeModalButton.addEventListener('click', function () {
                // Obtém a instância do modal Bootstrap e fecha
                const bootstrapModal = bootstrap.Modal.getOrCreateInstance(modalElement);
                bootstrapModal.hide();
            });
        } else {
            console.error("Botão ou elemento do modal não encontrados.");
        }
    });


</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const checkboxesHorario = document.querySelectorAll('#dropdown-options-horario input[type="checkbox"]');
        const titleHorario = document.getElementById('dropdown-title-horario');

        if (!titleHorario) {
            return;
        }

        function updateHorarioTitle() {
            const checkedOptionsHorario = Array.from(checkboxesHorario)
                .filter(cb => cb.checked)
                .map(cb => cb.value);

            titleHorario.textContent = checkedOptionsHorario.length > 0
                ? checkedOptionsHorario.join(', ')
                : 'Selecione a disponibilidade';
        }

        checkboxesHorario.forEach(cb => cb.addEventListener('change', updateHorarioTitle));

        updateHorarioTitle();
    });

    document.addEventListener('DOMContentLoaded', function () {
        const dropdownMenu = document.getElementById('dropdown-options');
        const dropdownToggle = document.getElementById('dropdownMenuButton');
        const dropdownTitle = document.getElementById('dropdown-title');

        if (!dropdownMenu || !dropdownTitle) {
            return;
        }

        const checkboxes = dropdownMenu.querySelectorAll('input[type="checkbox"]');

        function updateDropdownTitle() {
            const selectedOptions = Array.from(checkboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.value);

            const text = selectedOptions.length > 0 ? selectedOptions.join(', ') : 'Selecione as regiões';

            dropdownTitle.textContent = text;

            if (dropdownToggle) {
                dropdownToggle.title = text;
            }
        }

        checkboxes.forEach(cb => cb.addEventListener('change', updateDropdownTitle));

        updateDropdownTitle();
    });

    // Gerenciamento do dropdown de cargos
    document.addEventListener('DOMContentLoaded', function () {
        const checkboxesCargo = document.querySelectorAll('#dropdown-options-cargo input[type="checkbox"]');
        const titleCargo = document.getElementById('dropdown-title-cargo');

        // Atualiza o título com os cargos selecionados ao carregar a página
        function updateCargoTitle() {
            const checkedOptionsCargo = [];
            checkboxesCargo.forEach(function (cb) {
                if (cb.checked) {
                    checkedOptionsCargo.push(cb.value);
                }
            });
            titleCargo.textContent = checkedOptionsCargo.length > 0 ? checkedOptionsCargo.join(', ') : 'Selecione os cargos';
        }

        // Inicializa o título ao carregar
        updateCargoTitle();

        // Atualiza o título quando um checkbox é alterado
        checkboxesCargo.forEach(function (checkbox) {
            checkbox.addEventListener('change', function () {
                updateCargoTitle();
            });
        });
    });

    $(document).ready(function () {
        // Função para enviar os filtros via Ajax


        // Reatribui os event listeners necessários após a atualização da tabela
        function reatribuirEventListeners() {
            const selectAllCheckbox = document.getElementById('selectAll');
            const openPdfModalButton = document.getElementById('openPdfModalButton');
            const checkboxes = document.querySelectorAll('.select-checkbox');

            // Função para exibir ou ocultar o botão do modal
            function toggleGeneratePdfButton() {
                const selectedCheckboxes = document.querySelectorAll('.select-checkbox:checked');
                openPdfModalButton.style.display = selectedCheckboxes.length > 0 ? 'block' : 'none';
            }

            // Listener para selecionar todos os checkboxes
            selectAllCheckbox?.addEventListener('change', function () {
                checkboxes.forEach(checkbox => {
                    checkbox.checked = this.checked;
                });
                toggleGeneratePdfButton();
            });

            // Listener para cada checkbox individual
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', toggleGeneratePdfButton);
            });

            // Chama a função ao carregar a tabela para verificar o estado inicial
            toggleGeneratePdfButton();
        }

        // Inicializa o carregamento da tabela e filtros ao abrir a página
        carregarFiltros();



    });
    // Carregar os resultados na primeira vez que a página é carregada
    carregarFiltros();

    document.getElementById('createFichaForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const nomeCompleto = document.getElementById('nomeCompleto').value;
        const cpf = document.getElementById('cpf').value;

        fetch('/create_ficha_manual', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                nome_completo: nomeCompleto,
                cpf: cpf
            })
        })
            .then(response => {
                if (!response.ok) {
                    // Se a resposta não for OK (status 400), retorna a mensagem de erro
                    return response.json().then(data => { throw new Error(data.message); });
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    // Redireciona para o formulário criado se o CPF for novo
                    window.location.href = `/view_form/${data.cpf}`;
                }
            })
            .catch(error => {
                // Exibe um alerta se o CPF já existir
                alert(error.message);
            });
    });

    // Inicializa o socket.io
    var socket = io.connect('http://' + document.domain + ':' + location.port + '/');

    // Escuta evento de nova ficha
    socket.on('new_ficha', function (data) {
        const tabela = document.getElementById('candidato-table');
        const newRow = document.createElement('tr');
        newRow.innerHTML = `
<td>${data.nome_completo}</td>
<td>${data.cpf}</td>
<td>${data.created_at}</td>
<td>
    <a href="/view_form/${data.cpf}" class="btn btn-primary">Visualizar/Editar</a>
    <a href="/export_pdf/${data.cpf}" class="btn btn-danger btn-sm">Exportar PDF</a>
    <a href="/export_excel/${data.cpf}" class="btn btn-success btn-sm">Exportar Excel</a>
</td>
`;
        tabela.appendChild(newRow);
    });

    document.getElementById('createFichaForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const nomeCompleto = document.getElementById('nomeCompleto').value;
        const cpf = document.getElementById('cpf').value;

        fetch('/create_ficha_manual', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                nome_completo: nomeCompleto,
                cpf: cpf
            })
        })
            .then(response => {
                if (!response.ok) {
                    // Se a resposta não for OK (status 400 ou 500)
                    return response.json().then(data => { throw new Error(data.message); });
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    // Redireciona para a página do formulário criado
                    window.location.href = `/view_form/${data.cpf}`;
                }
            })
            .catch(error => {
                // Exibe o erro caso o CPF já exista ou outro erro
                alert(error.message);
            });
    });

    socket.on('situacao_updated', function (data) {
        // Encontra a linha da tabela correspondente ao CPF
        const rows = document.querySelectorAll('#candidato-table tr');
        rows.forEach(row => {
            const cpfCell = row.querySelector('td:nth-child(1) input[type="checkbox"]');
            if (cpfCell && cpfCell.value === data.cpf) {
                // Atualiza a célula de situação
                const situacaoCell = row.querySelector('td:nth-child(7)');
                if (situacaoCell) {
                    situacaoCell.textContent = data.situacao;
                }
            }
        });
    });
</script>
{% endblock %}